(function(){angular.module("loc8rApp",["ngRoute","ngSanitize","ui.bootstrap"]);function o(o,e){o.when("/",{templateUrl:"/home/home.view.html",controller:"homeController",controllerAs:"vm"}).when("/about",{templateUrl:"/common/views/genericText.view.html",controller:"aboutController",controllerAs:"vm"}).when("/location/:locationId",{templateUrl:"/locationDetail/locationDetail.view.html",controller:"locationDetailController",controllerAs:"vm"}).otherwise({redirectTo:"/"});e.html5Mode(true);e.hashPrefix("")}angular.module("loc8rApp").config(["$routeProvider","$locationProvider",o])})();(function(){angular.module("loc8rApp").controller("homeController",o);o.$inject=["$scope","loc8rData","geoLocation"];function o(e,t,o){var n=this;n.pageHeader={title:"Loc8r",strapline:"Find places to work with wifi near you!"};n.sidebar={content:"Looking for wifi and a seat? Loc8r helps you find places to work when out and about. Perhaps with coffee, cake or a pint? Let Loc8r help you find the place you're looking for."};n.message="Checking your location";n.getData=function(o){var e=o.coords.latitude;lng=o.coords.longitude;n.message="Searching for nearby places";t.locationByCoords(e,lng).then(function o(e){n.message=e.data.length>0?"":"No locations found";n.data={locations:e.data}},function o(e){n.message="Sorry, something's gone wrong"})};n.showError=function(o){e.$apply(function(){n.message=o.message})};n.noGeo=function(){e.$apply(function(){n.message="Geolocation not supported by this browser."})};o.getPosition(n.getData,n.showError,n.noGeo)}})();(function(){angular.module("loc8rApp").controller("aboutController",o);function o(){var o=this;o.pageHeader={title:"About Loc8r"};o.main={content:'Loc8r was created to help people find places to sit down and get a bit of work done.\n\nIn the fictional universe of Star Trek, Starfleet Academy is where recruits to Starfleet\'s officer corps are trained. It was created in the year 2161, when the United Federation of Planets was founded. The Academy\'s motto is "Ex astris, scientia" – "From the stars, knowledge." This is derived from the Apollo 13 motto "Ex luna, scientia" – "From the moon, knowledge." In turn, the Apollo 13 motto was inspired by "Ex scientia, tridens," the motto of the United States Naval Academy, meaning "From knowledge, seapower."'}}})();(function(){angular.module("loc8rApp").controller("locationDetailController",o);o.$inject=["$routeParams","$uibModal","loc8rData"];function o(o,e,t){var n=this;n.locationId=o.locationId;t.locationById(n.locationId).then(function o(e){n.data={location:e.data};n.pageHeader={title:n.data.location.name};n.googleMapsApiKey=process.env.GOOGLE_MAPS_API_KEY},function o(e){console.log(e)});n.popupReviewForm=function(){var o=e.open({templateUrl:"/reviewModal/reviewModal.view.html",controller:"reviewModalController as vm",resolve:{locationData:function(){return{locationId:n.locationId,locationName:n.data.location.name}}}});o.result.then(function(o){console.log(JSON.stringify(o));n.data.location.reviews.push(o)})}}})();(function(){angular.module("loc8rApp").controller("reviewModalController",o);o.$inject=["$uibModalInstance","loc8rData","locationData"];function o(e,t,o){var n=this;n.locationData=o;n.onSubmit=function(){n.formError="";if(!n.formData.name||!n.formData.rating||!n.formData.reviewText){n.formError="All fields are required, please try again";return false}else{n.doAddReview(n.locationData.locationId,n.formData)}};n.doAddReview=function(o,e){t.addReviewByLocationId(o,{author:e.name,rating:e.rating,reviewText:e.reviewText}).then(function o(e){console.log(JSON.stringify(e));n.modal.close(e.data)},function o(e){console.log(JSON.stringify(e));n.formError="Your review has not been saved, try again"});return false};n.modal={close:function(o){e.close(o)},cancel:function(){console.log("dismissed");e.dismiss("cancel")}}}})();(function(){angular.module("loc8rApp").service("geoLocation",o);function o(){var o=function(o,e,t){if(navigator.geolocation){navigator.geolocation.getCurrentPosition(o,e)}else{t()}};return{getPosition:o}}})();(function(){angular.module("loc8rApp").service("loc8rData",o);o.$inject=["$http"];function o(t){var o=function(o,e){return t.get("/api/v1/locations?lng="+e+"&lat="+o+"&maxDistance=20")};var e=function(o){return t.get("/api/v1/locations/"+o)};var n=function(o,e){return t.post("/api/v1/locations/"+o+"/reviews",e)};return{locationByCoords:o,locationById:e,addReviewByLocationId:n}}})();(function(){angular.module("loc8rApp").filter("formatDistance",o);var n=function(o){return!isNaN(parseFloat(o))&&isFinite(o)};function o(){return function(o){var e,t;if((o||o===0)&&n(o)){if(o>1){e=parseFloat(o).toFixed(1);t="km"}else{e=parseInt(o*1e3,10);t="m"}return e+t}else{return"?"}}}})();(function(){angular.module("loc8rApp").filter("addHtmlLineBreaks",o);function o(){return function(o){var e;if(!o){e=o}else{e=o.replace(/\n/g,"<br/>")}return e}}})();(function(){angular.module("loc8rApp").directive("ratingStars",o);function o(){return{restrict:"EA",scope:{rating:"=rating"},templateUrl:"/common/directives/ratingStars/ratingStars.template.html"}}})();(function(){angular.module("loc8rApp").directive("pageHeader",o);function o(){return{restrict:"EA",scope:{content:"=content"},templateUrl:"/common/directives/pageHeader/pageHeader.template.html"}}})();(function(){angular.module("loc8rApp").directive("navigation",o);function o(){return{restrict:"EA",templateUrl:"/common/directives/navigation/navigation.template.html"}}})();(function(){angular.module("loc8rApp").directive("footerGeneric",o);function o(){return{restrict:"EA",templateUrl:"/common/directives/footerGeneric/footerGeneric.template.html"}}})();